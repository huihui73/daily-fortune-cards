# 🧪 每日推算卡 - 完整测试指南

## 📋 测试环境准备

### 1. 文件位置
所有测试文件位于 `test/` 目录下：
```
test/
├── test.html          # 主页面文件
├── fortune-engine.js  # 推算引擎
├── test-app.js        # 应用逻辑
├── README.md          # 使用说明
├── start.sh           # Mac/Linux 启动脚本
├── start.bat          # Windows 启动脚本
└── TESTING_GUIDE.md   # 本文件
```

### 2. 打开方式

#### 🌟 推荐方式：直接打开
1. 在文件管理器中找到 `test/test.html`
2. 双击打开（自动使用默认浏览器）
3. 开始测试！

**优点**：最简单，无需任何工具

#### 💻 开发方式：本地服务器
**Mac/Linux 用户**:
```bash
cd /Users/gonghuihui/daily-fortune-cards/test
./start.sh
```

**Windows 用户**:
```bash
cd test
start.bat
```

然后在浏览器中访问：`http://localhost:8000/test.html`

**优点**：支持所有浏览器功能，适合开发调试

#### 🔧 VS Code 用户
1. 在 VS Code 中打开 `test/test.html`
2. 安装 "Live Server" 扩展
3. 右键文件 → "Open with Live Server"

**优点**：自动刷新，开发体验最佳

## 🧪 完整测试流程

### 第一阶段：基础功能测试

#### 测试 1：页面加载
**步骤**:
1. 打开 `test.html`
2. 观察页面是否完整加载
3. 检查是否有报错（F12 → Console）

**预期结果**:
- ✅ 页面完整显示
- ✅ 显示登录引导卡片
- ✅ 显示输入区域（生日、性别）
- ✅ 显示生成按钮
- ✅ 显示空状态提示

---

#### 测试 2：用户认证
**步骤**:
1. 点击"使用微信手机号登录"按钮
2. 观察提示信息
3. 观察UI变化

**预期结果**:
- ✅ 显示"授权成功"提示
- ✅ 登录引导卡片消失
- ✅ 显示用户信息卡片
- ✅ 显示脱敏手机号（138****5678）
- ✅ 显示"已登录"状态

**额外测试**:
- 点击"退出"按钮
- 验证登录状态清除
- 验证UI恢复到初始状态

---

#### 测试 3：资料输入 - 生日
**步骤**:
1. 点击生日输入框
2. 选择一个日期（例如：1990-01-01）
3. 刷新页面（F5）
4. 检查生日是否保存

**预期结果**:
- ✅ 日期选择器正常工作
- ✅ 生日显示在输入框中
- ✅ 刷新后生日仍然存在
- ✅ 生日正确保存到 LocalStorage

**检查方法**:
- 按 F12 → Application → Local Storage
- 查找 `fortune_birthday` 键
- 验证值是否正确

---

#### 测试 4：资料输入 - 性别
**步骤**:
1. 选择性别（男/女/保密）
2. 刷新页面（F5）
3. 检查性别是否保存

**预期结果**:
- ✅ 性别选项正常工作
- ✅ 选中的性别正确标记
- ✅ 刷新后性别仍然存在
- ✅ 性别正确保存到 LocalStorage

---

### 第二阶段：推算功能测试

#### 测试 5：生成推算
**步骤**:
1. 确保已登录并设置生日
2. 点击"生成今日卡片"按钮
3. 观察加载状态

**预期结果**:
- ✅ 按钮变为"生成中..."状态
- ✅ 显示加载旋转动画
- ✅ 显示"正在为您推算今日运势..."提示
- ✅ 约0.5秒后显示推算结果
- ✅ 显示"生成成功"提示

**检查点**:
- 生成按钮恢复为可用状态
- 空状态提示消失
- 卡片区域显示

---

#### 测试 6：卡片显示
**步骤**:
1. 查看生成的卡片列表
2. 验证卡片数量
3. 验证卡片内容

**预期结果**:
- ✅ 显示10张卡片
- ✅ 卡片标题正确：
  1. 本日卦象
  2. 生命路径
  3. 五行平衡
  4. 幸运要素
  5. 穿衣灵感
  6. 饮食建议
  7. 每日微任务
  8. 日记 Prompts
  9. 健康提醒
  10. 隐私说明

---

### 第三阶段：卡片交互测试

#### 测试 7：卡片展开/收起
**步骤**:
1. 点击任意卡片的头部
2. 观察卡片内容
3. 再次点击同一卡片
4. 观察卡片变化

**预期结果**:
- ✅ 第一次点击：卡片内容展开
- ✅ 展开动画流畅
- ✅ 切换图标从"+"变为"−"
- ✅ 第二次点击：卡片内容收起
- ✅ 收起动画流畅
- ✅ 切换图标从"−"变为"+"

**额外测试**:
- 测试多张卡片的展开/收起
- 验证卡片状态互不影响

---

#### 测试 8：卡片复制功能
**步骤**:
1. 展开任意卡片
2. 点击"📋 复制"按钮
3. 观察提示
4. 粘贴到文本编辑器验证

**预期结果**:
- ✅ 显示"已复制"提示
- ✅ 提示2秒后自动消失
- ✅ 粘贴内容正确

---

#### 测试 9：五行条形图可视化
**步骤**:
1. 展开"五行平衡"卡片
2. 观察五行条形图
3. 检查条形图颜色和长度

**预期结果**:
- ✅ 显示5个五行条形图（木火土金水）
- ✅ 每个条形图有正确的颜色
  - 木：绿色 #52c41a
  - 火：红色 #ff4d4f
  - 土：黄色 #faad14
  - 金：灰色 #bfbfbf
  - 水：蓝色 #1890ff
- ✅ 条形图长度反映强弱程度
- ✅ 弱项显示建议文本
- ✅ 条形图有动画效果

---

#### 测试 10：幸运色可视化
**步骤**:
1. 展开"幸运要素"卡片
2. 观察幸运色展示
3. 检查颜色圆圈和信息

**预期结果**:
- ✅ 显示幸运色圆形
- ✅ 圆形颜色与幸运色一致
- ✅ 显示幸运色名称
- ✅ 显示十六进制颜色代码
- ✅ 显示色彩寓意
- ✅ 显示色彩建议

---

#### 测试 11：微任务打卡功能
**步骤**:
1. 展开"每日微任务"卡片
2. 观察任务列表
3. 点击第一个任务
4. 观察任务状态变化
5. 继续点击其他任务
6. 观察进度条变化
7. 完成所有任务

**预期结果**:
- ✅ 显示3个微任务
- ✅ 显示任务完成统计（0/3）
- ✅ 显示进度条（0%）
- ✅ 点击任务后任务背景变化
- ✅ 任务文本添加删除线
- ✅ 勾选图标显示"✓"
- ✅ 任务统计更新（1/3, 2/3, 3/3）
- ✅ 进度条更新（33%, 66%, 100%）
- ✅ 完成所有任务后显示祝贺动画
- ✅ 显示"🎉 全部完成！"提示

**额外测试**:
- 刷新页面（F5）
- 验证任务状态保持不变

---

### 第四阶段：数据持久化测试

#### 测试 12：推算结果缓存
**步骤**:
1. 生成推算结果
2. 刷新页面（F5）
3. 验证推算结果是否保持

**预期结果**:
- ✅ 推算结果自动加载
- ✅ 无需重新生成
- ✅ 卡片内容完全一致

**检查方法**:
- F12 → Application → Local Storage
- 查找 `fortune_YYYY-MM-DD` 格式的键
- 验证数据存在

---

#### 测试 13：任务状态持久化
**步骤**:
1. 生成推算结果
2. 完成部分任务（例如1个）
3. 刷新页面（F5）
4. 验证任务状态

**预期结果**:
- ✅ 任务状态保持不变
- ✅ 已完成的任务仍然显示为完成状态
- ✅ 进度条显示正确的进度

**检查方法**:
- F12 → Application → Local Storage
- 查找 `tasks_fortune_YYYY-MM-DD` 格式的键
- 验证数据存在

---

#### 测试 14：用户资料持久化
**步骤**:
1. 设置生日和性别
2. 登录（授权手机号）
3. 刷新页面（F5）
4. 验证所有数据

**预期结果**:
- ✅ 生日正确加载
- ✅ 性别正确加载
- ✅ 登录状态保持
- ✅ 手机号显示正确

---

### 第五阶段：边界测试

#### 测试 15：未登录状态
**步骤**:
1. 退出登录
2. 清除 LocalStorage（可选）
3. 尝试生成推算

**预期结果**:
- ✅ 如果已设置生日，可以生成推算
- ✅ 如果未设置生日，显示错误提示
- ✅ 提示"请选择生日"

---

#### 测试 16：日期变化测试
**步骤**:
1. 在控制台执行：
```javascript
appState.today = '2025-01-16';
appState.lastGenerateDate = '2025-01-15';
checkAndRegenerate();
```

**预期结果**:
- ✅ 自动生成新日期的推算结果
- ✅ 推算结果基于新日期计算

---

#### 测试 17：不同生日测试
**步骤**:
1. 选择不同的生日（1990-01-01）
2. 生成推算结果
3. 更换生日（1995-05-15）
4. 重新生成推算结果
5. 对比两次结果

**预期结果**:
- ✅ 两次推算结果不同
- ✅ 卦象、五行、幸运色等都有变化
- ✅ 任务也可能不同

---

### 第六阶段：性能测试

#### 测试 18：生成速度
**步骤**:
1. 点击"生成今日卡片"按钮
2. 观察生成时间

**预期结果**:
- ✅ 生成时间 < 1秒
- ✅ 加载动画显示正常
- ✅ 无明显卡顿

---

#### 测试 19：卡片渲染性能
**步骤**:
1. 快速展开/收起多张卡片
2. 观察动画流畅度

**预期结果**:
- ✅ 动画流畅无卡顿
- ✅ 多张卡片可以同时展开/收起
- ✅ 无渲染错误

---

## 📊 测试报告模板

### 测试环境
- **测试日期**: ___________
- **测试人员**: ___________
- **浏览器**: ___________
- **操作系统**: ___________

### 测试结果

| 测试编号 | 测试项目 | 测试结果 | 备注 |
|---------|---------|---------|------|
| 1 | 页面加载 | ⬜ 通过 / ❌ 失败 | |
| 2 | 用户认证 | ⬜ 通过 / ❌ 失败 | |
| 3 | 资料输入-生日 | ⬜ 通过 / ❌ 失败 | |
| 4 | 资料输入-性别 | ⬜ 通过 / ❌ 失败 | |
| 5 | 生成推算 | ⬜ 通过 / ❌ 失败 | |
| 6 | 卡片显示 | ⬜ 通过 / ❌ 失败 | |
| 7 | 卡片展开/收起 | ⬜ 通过 / ❌ 失败 | |
| 8 | 卡片复制功能 | ⬜ 通过 / ❌ 失败 | |
| 9 | 五行条形图可视化 | ⬜ 通过 / ❌ 失败 | |
| 10 | 幸运色可视化 | ⬜ 通过 / ❌ 失败 | |
| 11 | 微任务打卡功能 | ⬜ 通过 / ❌ 失败 | |
| 12 | 推算结果缓存 | ⬜ 通过 / ❌ 失败 | |
| 13 | 任务状态持久化 | ⬜ 通过 / ❌ 失败 | |
| 14 | 用户资料持久化 | ⬜ 通过 / ❌ 失败 | |
| 15 | 未登录状态 | ⬜ 通过 / ❌ 失败 | |
| 16 | 日期变化测试 | ⬜ 通过 / ❌ 失败 | |
| 17 | 不同生日测试 | ⬜ 通过 / ❌ 失败 | |
| 18 | 生成速度 | ⬜ 通过 / ❌ 失败 | |
| 19 | 卡片渲染性能 | ⬜ 通过 / ❌ 失败 | |

### 问题记录

| 问题编号 | 问题描述 | 严重程度 | 状态 |
|---------|---------|---------|------|
| | | | |

### 测试总结
**通过率**: ____/19 (____%)

**主要问题**: ___________

**改进建议**: ___________

## 🐛 常见问题排查

### 问题1：页面无法打开
**症状**: 双击 test.html 文件后，浏览器报错

**解决方案**:
1. 检查文件路径是否正确
2. 尝试使用其他浏览器（Chrome, Firefox）
3. 使用本地服务器方式打开

---

### 问题2：推算失败
**症状**: 点击生成按钮后显示"生成失败"

**解决方案**:
1. 打开浏览器控制台（F12）
2. 查看 Console 标签中的错误信息
3. 确保 fortune-engine.js 文件存在
4. 清除浏览器缓存重试

---

### 问题3：数据不保存
**症状**: 刷新页面后数据丢失

**解决方案**:
1. 检查浏览器是否禁用 LocalStorage
2. 尝试使用无痕模式
3. 检查浏览器控制台是否有存储错误

---

### 问题4：复制功能不工作
**症状**: 点击复制按钮后无反应

**解决方案**:
1. 检查浏览器是否支持 Clipboard API
2. 尝试使用最新版本的 Chrome 或 Firefox
3. 检查浏览器权限设置

---

## 📞 获取帮助

如果在测试过程中遇到问题：

1. **查看控制台日志**（F12 → Console）
2. **检查本地存储**（F12 → Application → Local Storage）
3. **阅读本指南的常见问题部分**
4. **联系开发人员反馈**

---

**祝测试顺利！🎉**